<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_ground</spriteName>
  <solid>0</solid>
  <visible>0</visible>
  <depth>1000</depth>
  <persistent>0</persistent>
  <parentName>obj_xyz</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>width=sprite_width;
height=sprite_height;
zbot=-1000
surf=-1;

//allows players to move up/down the surface.
//Don't enable for non-sloped surfaces, since it's slow.
slope_px=0;

strip_thickness=config.STRIP_THICKNESS;

strips[0]=noone;

no_cliffs=false;

tint_edges=false;
edge_tint_col=c_white;
edge_tint_a=0.05;
edge_tint_thickness=3;

//registered in room properties
registered=false;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>unregister_ground</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>this</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
          <argument>
            <kind>0</kind>
            <string></string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>image_xscale=width/32;
image_yscale=height/32;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="12">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (!no_cliffs) {
    cr = instance_create(x+width,y,cliff)
    cr.z=z;
    cr.length=height;
    cr.height=z-zbot;
    cr.dir=1;
    
    cl = instance_create(x,y,cliff)
    cl.z=z;
    cl.length=height;
    cl.dir=-1;
    cl.height=z-zbot;
    
    //run cliff set-up (makes strips);
    with (cr) {event_user(0)}
    with (cl) {event_user(0)}
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>split graphics into strips</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (!surface_exists(surf)&amp;&amp;use_surf) {
    //render surface:
    surf=surface_create(surf_w,surf_h);
    surface_set_target(surf);
    draw_reset();
    draw_clear_alpha(c_black,0);
    for (i=0;i&lt;cn;i++){
        var cx=child_x[i]-minx;
        var cy=child_y[i]-miny;
        draw_background_part(child_bg[i],child_left[i],child_top[i],child_w[i],child_h[i],cx,cy);
    }
    if (tint_edges) {
        //apply edge tint
        draw_set_color(edge_tint_col);
        draw_set_alpha(edge_tint_a);
        draw_set_colour_write_enable(true, true, true, false)
        draw_rectangle(0,0,surf_w,edge_tint_thickness,false);
        draw_rectangle(0,surf_h-edge_tint_thickness,surf_w,surf_h,false);
        draw_rectangle(0,edge_tint_thickness,edge_tint_thickness,surf_h-edge_tint_thickness,false);
        draw_rectangle(surf_w-edge_tint_thickness,edge_tint_thickness,surf_w,surf_h-edge_tint_thickness,false);
        draw_set_colour_write_enable(true, true, true, true)
    }
    surface_reset_target();
    draw_reset();
    //split texture over strips:
    var strip_surf;
    var strip
    for (var i=0;i&lt;surf_h/strip_thickness;i++){
        strip_surf=surface_create(surf_w,strip_thickness);
        surface_set_target(strip_surf);
        draw_clear_alpha(c_black,0)
        draw_surface_part(surf,0,strip_thickness*i,surf_w,strip_thickness,0,0);
        strip = instance_create(minx,y+strip_thickness*i,ground_strip)
        strip.z=z
        strip.surf=strip_surf;
        strip.surf_w=surf_w;
        strip.surf_h=strip_thickness
        strip.parent=id;
        surface_reset_target();
        strips[i]=strip
        strips[i+1]=noone;
    }
    surface_reset_target();   
    surface_free(surf);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>find tiles</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//allows drawing over tiles.
depth+=1;

//grab all tiles in region at depth:
children=tile_get_ids_at_depth(depth);
cn = array_length_1d(children);


child_x[cn]=0;
child_y[cn]=0;
child_h[cn]=0;
child_w[cn]=0;
child_bg[cn]=0;
child_left[cn]=0;
child_top[cn]=0;
miny=10000;
maxy=-10000;
minx=1000000;
maxx=0;
for (i=0;i&lt;cn;i++) {
    child = children[i]
    if (!tile_exists(child)) {
        cn=i-1;
        break;
    }
    child_y[i]=tile_get_y(child);
    if (child_y[i]&lt;miny)
        miny=child_y[i]
    child_x[i]=tile_get_x(child);
    if (child_x[i]&lt;minx)
        minx=child_x[i]
    child_h[i]=tile_get_height(child);
    if (child_y[i]+child_h[i]&gt;maxy)
        maxy=child_y[i]+child_h[i]
    child_w[i]=tile_get_width(child);
    if (child_x[i]+child_w[i]&gt;maxx)
        maxx=child_x[i]+child_w[i]
    child_bg[i]=tile_get_background(child)
    child_left[i]=tile_get_left(child);
    child_top[i]=tile_get_top(child);
    tile_delete(child);
}

surf_w=maxx-minx;
surf_h=ceil((maxy-miny)/strip_thickness)*strip_thickness;
use_surf=true;
if (abs(surf_w)&gt;4000 || abs(surf_h) &gt; 3000||surf_w&lt;0||surf_h&lt;0)
    use_surf=false

//allows drawing over tiles.
depth-=1;

//split into strips
if (cn&gt;0)
    event_user(1)

//create cliffs:
event_user(2);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="4">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_user(0);
register_ground(this);
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
